import streamlit as st
import pandas as pd
import requests
import time
import json
import os
from datetime import datetime, timedelta
from operator import itemgetter
from streamlit_autorefresh import st_autorefresh

# --- 2. DefiniÃ§Ã£o das VariÃ¡veis Globais ---
# ATENÃ‡ÃƒO: NGROK_AUTH_TOKEN e LOG/EXECUÃ‡ÃƒO SÃƒO REMOVIDOS.

# ğŸ›‘ WEBHOOK DE RELATÃ“RIO DIÃRIO (MANTIDO)
GOOGLE_CHAT_WEBHOOK_RELATORIO = "https://chat.googleapis.com/v1/spaces/AAQA0V8TAhs/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=Zl7KMv0PLrm5c7IMZZdaclfYoc-je9ilDDAlDfqDMAU"

# â¬‡ï¸ NOVO WEBHOOK PARA NOTIFICAÃ‡ÃƒO IMEDIATA DE TROCA DE BASTÃƒO (ATUALIZADO)
CHAT_WEBHOOK_BASTAO = "https://chat.googleapis.com/v1/spaces/AAQA5CyNolU/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=Zolqmc0YfJ5bPzsqLrefwn8yBbNQLLfFBzLTwIkr7W4"

BASTAO_EMOJI = "ğŸŒ¸"

# â¬…ï¸ URL PERMANENTE DO SEU APP (CORRIGIDO)
APP_URL_CLOUD = 'https://controle-bastao-cesupe.streamlit.app'

# ğŸ†• LISTA DE CONSULTORES (AJUSTADA)
CONSULTORES = [
    "Alex", "Dirceu N.", "Douglas", "Hugo", "Igor", "Jerry", 
    "JoÃ£o", "Jonatas", "Leandro", "Luiz", "Marcelo", "Marina S.", 
    "Marina T.", "Vanessa", "Gleis"
]

# --- 4. CÃ“DIGO DO APP STREAMLIT (app.py) ---
def generate_app_code(consultores, emoji, webhook_relatorio, webhook_bastao, public_url):
    app_code_lines = [
        "import streamlit as st",
        "import pandas as pd",
        "import requests",
        "import time",
        "import json",
        "import os",
        "from datetime import datetime, timedelta",
        "from operator import itemgetter",
        "from streamlit_autorefresh import st_autorefresh",
        "",
        f"BASTAO_EMOJI = '{emoji}'",
        f"CONSULTORES = {consultores}",
        f"WEBHOOK_RELATORIO = '{webhook_relatorio}'", # CORRIGIDO: Removido U+00A0
        f"WEBHOOK_BASTAO = '{webhook_bastao}'",
        f"APP_URL = '{public_url}'",
        "TIMER_RERUN_S = 30",
        "LOG_FILE = 'status_log.json'",
        "STATE_FILE = 'app_state.json'",
        "YOUTUBE_ID = 'yW0D5iK0i_A'",
        "START_TIME_S = 10",
        "PLAYBACK_TIME_MS = 10000",
        "STATUS_SAIDA_PRIORIDADE = ['SaÃ­da TemporÃ¡ria']",
        "STATUSES_DE_SAIDA = ['Atividade', 'AlmoÃ§o', 'SaÃ­da TemporÃ¡ria']",
        "GIF_URL = 'https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExY2pjMDN0NGlvdXp1aHZ1ejJqMnY5MG1yZmN0d3NqcDl1bTU1dDJrciZlcD12MV9pbnRlcm5uYWxfZ2lmX2J5X2lkJmN0PWc/fXnRObM8Q0RkOmR5nf/giphy.gif'",
        "",
        "# --- FunÃ§Ãµes de PersistÃªncia de Estado ---",
        "",
        "def date_serializer(obj):",
        "Â  Â  if isinstance(obj, datetime):",
        "Â  Â  Â  Â  return obj.isoformat()",
        "Â  Â  return str(obj)",
        "",
        "def save_state():",
        "Â  Â  state_to_save = {",
        "Â  Â  Â  Â  'status_texto': st.session_state.status_texto,",
        "Â  Â  Â  Â  'bastao_queue': st.session_state.bastao_queue,",
        "Â  Â  Â  Â  'bastao_start_time': st.session_state.bastao_start_time,",
        "Â  Â  Â  Â  'current_status_starts': st.session_state.current_status_starts,",
        "Â  Â  Â  Â  'report_last_run_date': st.session_state.report_last_run_date,",
        "Â  Â  Â  Â  'bastao_counts': st.session_state.bastao_counts,",
        "Â  Â  Â  Â  'priority_return_queue': st.session_state.priority_return_queue,",
        "Â  Â  Â  Â  'skip_status_display': st.session_state.skip_status_display,",
        "Â  Â  Â  Â  'skipped_consultors': st.session_state.skipped_consultors,",
        "Â  Â  Â  Â  'cycle_start_marker': st.session_state.cycle_start_marker,",
        "Â  Â  }",
        "Â  Â  try:",
        "Â  Â  Â  Â  with open(STATE_FILE, 'w') as f:",
        "Â  Â  Â  Â  Â  Â  json.dump(state_to_save, f, indent=4, default=date_serializer)",
        "Â  Â  except Exception as e:",
        "Â  Â  Â  Â  print(f'Erro ao salvar estado: {e}')",
        "",
        "def load_state():",
        "Â  Â  if os.path.exists(STATE_FILE):",
        "Â  Â  Â  Â  try:",
        "Â  Â  Â  Â  Â  Â  with open(STATE_FILE, 'r') as f:",
        "Â  Â  Â  Â  Â  Â  Â  Â  data = json.load(f)",
        "Â  Â  Â  Â  Â  Â  ",
        "Â  Â  Â  Â  Â  Â  for key in ['bastao_start_time', 'report_last_run_date']:",
        "Â  Â  Â  Â  Â  Â  Â  Â  if data.get(key):",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  data[key] = datetime.fromisoformat(data[key])",
        "Â  Â  Â  Â  Â  Â  for consultor, time_str in data['current_status_starts'].items():",
        "Â  Â  Â  Â  Â  Â  Â  Â  data['current_status_starts'][consultor] = datetime.fromisoformat(time_str)",
        "Â  Â  Â  Â  Â  Â  ",
        "Â  Â  Â  Â  Â  Â  return data",
        "Â  Â  Â  Â  except (FileNotFoundError, json.JSONDecodeError, KeyError) as e:",
        "Â  Â  Â  Â  Â  Â  print(f'Erro ao carregar estado: {e}. Iniciando estado padrÃ£o.')",
        "Â  Â  Â  Â  Â  Â  return {}",
        "Â  Â  return {}",
        "",
        "# --- FunÃ§Ãµes de Log e NotificaÃ§Ã£o ---",
        "",
        "def send_chat_notification_internal(consultor, status):",
        "Â  Â  if WEBHOOK_BASTAO and status == 'BastÃ£o':",
        'Â  Â  Â  Â  message_template = "ğŸ‰ **BASTÃƒO GIRADO!** ğŸ‰ \\n\\n- **Novo ResponsÃ¡vel:** {consultor}\\n- **Acesse o Painel:** {app_url}" ',
        'Â  Â  Â  Â  message_text = message_template.format(consultor=consultor, app_url=APP_URL)',
        'Â  Â  Â  Â  chat_message = {"text": message_text}',
        'Â  Â  Â  Â  try:',
        'Â  Â  Â  Â  Â  Â  response = requests.post(WEBHOOK_BASTAO, json=chat_message)',
        'Â  Â  Â  Â  Â  Â  response.raise_for_status()',
        'Â  Â  Â  Â  Â  Â  return True',
        'Â  Â  Â  Â  except requests.exceptions.RequestException as e: ',
        'Â  Â  Â  Â  Â  Â  print("="*60)',
        'Â  Â  Â  Â  Â  Â  print(f"âŒ ERRO GRAVE: FALHA AO ENVIAR NOTIFICAÃ‡ÃƒO DE BASTÃƒO.")',
        'Â  Â  Â  Â  Â  Â  print(f"URL USADA: {WEBHOOK_BASTAO}")',
        'Â  Â  Â  Â  Â  Â  print(f"ERRO: {e}")',
        'Â  Â  Â  Â  Â  Â  if e.response is not None:',
        'Â  Â  Â  Â  Â  Â  Â  Â  print(f"STATUS CODE: {e.response.status_code}")',
        'Â  Â  Â  Â  Â  Â  Â  Â  print(f"RESPOSTA DO SERVIDOR: {e.response.text}")',
        'Â  Â  Â  Â  Â  Â  print("="*60)',
        'Â  Â  Â  Â  Â  Â  return False',
        'Â  Â  return False',
        "",
        "def play_sound_html():",
        'Â  Â  return """',
        '<audio autoplay="true">',
        'Â  Â  Â  Â  Â  Â  <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mp3">',
        '</audio>',
        '"""',
        "",
        "def load_logs():",
        "Â  Â  try:",
        "Â  Â  Â  Â  with open(LOG_FILE, 'r') as f:",
        "Â  Â  Â  Â  Â  Â  return json.load(f)",
        "Â  Â  except (FileNotFoundError, json.JSONDecodeError):",
        "Â  Â  Â  Â  return []",
        "def save_logs(logs):\n",
        "Â  Â  with open(LOG_FILE, 'w') as f: json.dump(logs, f, indent=4, default=date_serializer)",
        "def log_status_change(consultor, old_status, new_status, duration):",
        "Â  Â  logs = load_logs()",
        "Â  Â  log_entry = {",
        "Â  Â  Â  Â  'consultor': consultor,",
        "Â  Â  Â  Â  'old_status': old_status if old_status != '' else 'DisponÃ­vel',",
        "Â  Â  Â  Â  'new_status': new_status if new_status != '' else 'DisponÃ­vel',",
        "Â  Â  Â  Â  'duration_s': duration.total_seconds(),",
        "Â  Â  Â  Â  'start_time': datetime.now().isoformat(),",
        "Â  Â  Â  Â  'end_time': datetime.now().isoformat()",
        "Â  Â  }",
        "Â  Â  logs.append(log_entry)",
        "Â  Â  save_logs(logs)",
        "Â  Â  st.session_state['current_status_starts'][consultor] = datetime.now()",
        "Â  Â  save_state()",
        "",
        "def format_time_duration(duration):",
        "Â  Â  total_seconds = int(duration.total_seconds())",
        "Â  Â  hours = total_seconds // 3600",
        "Â  Â  minutes = (total_seconds % 3600) // 60",
        "Â  Â  seconds = total_seconds % 60",
        "Â  Â  return f'{hours:02}:{minutes:02}:{seconds:02}'",
        "",
        "def send_daily_report():",
        "Â  Â  logs = load_logs()",
        "Â  Â  today_str = datetime.now().date().isoformat()",
        "Â  Â  report_data = [log for log in logs if log['start_time'].startswith(today_str)]",
        "Â  Â  ",
        "Â  Â  if not report_data or not WEBHOOK_RELATORIO:",
        "Â  Â  Â  Â  st.session_state['report_last_run_date'] = datetime.now()",
        "Â  Â  Â  Â  save_state()",
        "Â  Â  Â  Â  return",
        "Â  Â  ",
        "Â  Â  TRACKED_STATUSES = ['BastÃ£o', 'Atividade', 'AlmoÃ§o', 'SaÃ­da TemporÃ¡ria', 'DisponÃ­vel', 'Pulou Turno (Assumido)']",
        "Â  Â  summary = {",
        "Â  Â  Â  Â  consultor: {status: {'count': 0, 'duration_s': 0} for status in TRACKED_STATUSES}",
        "Â  Â  Â  Â  for consultor in CONSULTORES",
        "Â  Â  }",
        "Â  Â  ",
        "Â  Â  for log in report_data:",
        "Â  Â  Â  Â  consultor = log['consultor']",
        "Â  Â  Â  Â  status_to_track = log['old_status']",
        "Â  Â  Â  Â  if log['new_status'] == 'Pulou Turno (Assumido)':",
        "Â  Â  Â  Â  Â  Â  status_to_track = log['new_status']",
        "Â  Â  Â  Â  Â  Â  ",
        "Â  Â  Â  Â  duration = log['duration_s']",
        "Â  Â  Â  Â  ",
        "Â  Â  Â  Â  if consultor in summary and status_to_track in TRACKED_STATUSES:",
        "Â  Â  Â  Â  Â  Â  summary[consultor][status_to_track]['duration_s'] += duration",
        "Â  Â  Â  Â  Â  Â  summary[consultor][status_to_track]['count'] += 1",
        "Â  Â  ",
        "Â  Â  report_text = ''",
        "Â  Â  total_movimentacoes = len(report_data)",
        "",
        "Â  Â  report_text += f'ğŸ“Š **RELATÃ“RIO DIÃRIO DE BASTÃƒO - {today_str}**\\n'",
        "Â  Â  report_text += f'**Total de MovimentaÃ§Ãµes:** {total_movimentacoes}\\n\\n'",
        "",
        "Â  Â  bastao_ranking = sorted(",
        "Â  Â  Â  Â  CONSULTORES,",
        "Â  Â  Â  Â  key=lambda c: summary.get(c, {}).get('BastÃ£o', {}).get('duration_s', 0),",
        "Â  Â  Â  Â  reverse=True",
        "Â  Â  )",
        "Â  Â  ",
        "Â  Â  for consultor in bastao_ranking:",
        "Â  Â  Â  Â  report_text += f'**--- {consultor} ---**\\n'",
        "Â  Â  Â  Â  consultor_summary = summary.get(consultor, {})",
        "Â  Â  Â  Â  ",
        "Â  Â  Â  Â  for status in TRACKED_STATUSES:",
        "Â  Â  Â  Â  Â  Â  data = consultor_summary.get(status, {'count': 0, 'duration_s': 0})",
        "Â  Â  Â  Â  Â  Â  if data['count'] > 0:",
        "Â  Â  Â  Â  Â  Â  Â  Â  duration_td = timedelta(seconds=data['duration_s'])",
        "Â  Â  Â  Â  Â  Â  Â  Â  duration_str = format_time_duration(duration_td)",
        "Â  Â  Â  Â  Â  Â  Â  Â  report_text += f'- *{status.replace(' (Assumido)', '')}*: {data['count']}x ({duration_str})\\n'",
        "Â  Â  Â  Â  ",
        "Â  Â  Â  Â  report_text += '\\n'",
        "",
        "Â  Â  chat_message = {",
        "Â  Â  Â  Â  'text': report_text,",
        "Â  Â  Â  Â  'cards': [",
        "Â  Â  Â  Â  Â  Â  {",
        "Â  Â  Â  Â  Â  Â  Â  Â  'header': {",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  'title': f'{BASTAO_EMOJI} RelatÃ³rio DiÃ¡rio do BastÃ£o - {today_str}',",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  'subtitle': 'Tempo e Contagem por Status',",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  'imageUrl': 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/11/Blue_and_white_graph.svg/1024px-Blue_and_white_graph.svg.png'",
        "Â  Â  Â  Â  Â  Â  Â  Â  },",
        "Â  Â  Â  Â  Â  Â  Â  Â  'sections': [",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  'widgets': [",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  'textParagraph': {'text': report_text.replace('\\n', '<br>')}",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ]",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }",
        "Â  Â  Â  Â  Â  Â  Â  Â  ]",
        "Â  Â  Â  Â  Â  Â  }",
        "Â  Â  Â  Â  ]",
        "Â  Â  }",
        "Â  Â  ",
        "Â  Â  try:",
        "Â  Â  Â  Â  response = requests.post(WEBHOOK_RELATORIO, json=chat_message)",
        "Â  Â  Â  Â  response.raise_for_status()",
        "Â  Â  Â  Â  st.session_state['report_last_run_date'] = datetime.now()",
        "Â  Â  Â  Â  save_state()",
        "Â  Â  except requests.exceptions.RequestException as e: ",
        "Â  Â  Â  Â  print('='*60)",
        "Â  Â  Â  Â  print(f'âŒ ERRO GRAVE: FALHA AO ENVIAR RELATÃ“RIO DIÃRIO.')",
        "Â  Â  Â  Â  print(f'URL USADA: {WEBHOOK_RELATORIO}')",
        "Â  Â  Â  Â  print(f'ERRO: {e}')",
        "Â  Â  Â  Â  if e.response is not None:",
        "Â  Â  Â  Â  Â  Â  print(f'STATUS CODE: {e.response.status_code}')",
        "Â  Â  Â  Â  Â  Â  print(f'RESPOSTA DO SERVIDOR: {e.response.text}')",
        "Â  Â  Â  Â  print('='*60)",
        "Â  Â  Â  Â  ",
        "Â  Â  st.rerun()",
        "",
        "# --- InicializaÃ§Ã£o do Session State ---",
        "",
        "def init_session_state():",
        "Â  Â  persisted_state = load_state()",
        "Â  Â  ",
        "Â  Â  default_datetime = datetime.now()",
        "Â  Â  default_date_min = datetime.min",
        "Â  Â  ",
        "Â  Â  st.session_state['status_texto'] = persisted_state.get('status_texto', {nome: '' for nome in CONSULTORES})",
        "Â  Â  st.session_state['bastao_queue'] = persisted_state.get('bastao_queue', [])",
        "Â  Â  st.session_state['bastao_start_time'] = persisted_state.get('bastao_start_time', None)",
        "Â  Â  st.session_state['current_status_starts'] = persisted_state.get('current_status_starts', {nome: default_datetime for nome in CONSULTORES})",
        "Â  Â  st.session_state['report_last_run_date'] = persisted_state.get('report_last_run_date', default_date_min)",
        "Â  Â  st.session_state['bastao_counts'] = persisted_state.get('bastao_counts', {nome: 0 for nome in CONSULTORES})",
        "Â  Â  st.session_state['priority_return_queue'] = persisted_state.get('priority_return_queue', [])",
        "Â  Â  st.session_state['skip_status_display'] = persisted_state.get('skip_status_display', {nome: False for nome in CONSULTORES})",
        "Â  Â  st.session_state['skipped_consultors'] = persisted_state.get('skipped_consultors', [])",
        "Â  Â  st.session_state['cycle_start_marker'] = persisted_state.get('cycle_start_marker', None)",
        "Â  Â  ",
        "Â  Â  for nome in CONSULTORES:",
        "Â  Â  Â  Â  checkbox_key = f'check_{nome}'",
        "Â  Â  Â  Â  if checkbox_key not in st.session_state:",
        "Â  Â  Â  Â  Â  Â  st.session_state[checkbox_key] = nome in persisted_state.get('bastao_queue', []) or nome in st.session_state['skipped_consultors']",
        "Â  Â  \n",
        "Â  Â  if not os.path.exists(STATE_FILE):",
        "Â  Â  Â  Â  save_state()",
        "",
        "# --- LÃ³gica Principal ---",
        "",
        "def manual_rerun():",Â 
        "Â  Â  st.session_state['gif_warning'] = False ",Â 
        "Â  Â  st.rerun()",Â 
        "Â  Â  ",
        "def check_and_assume_baton(consultor=None):\n",
        "Â  Â  current_responsavel = st.session_state['bastao_queue'][0] if st.session_state['bastao_queue'] else ''\n",
        "Â  Â  \n",
        "Â  Â  if current_responsavel and st.session_state['status_texto'].get(current_responsavel) == 'BastÃ£o':\n",
        "Â  Â  Â  Â  return\n",
        "Â  Â  \n",
        "Â  Â  for index, nome in enumerate(st.session_state['bastao_queue']):",
        "Â  Â  Â  Â  current_status = st.session_state['status_texto'].get(nome, '')\n",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  if nome in st.session_state['skipped_consultors']:\n",
        "Â  Â  Â  Â  Â  Â  Â continue \n",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  if current_status == '' and nome not in st.session_state['skipped_consultors']:",
        "Â  Â  Â  Â  Â  Â  # LÃ³gica de Assumir o BastÃ£o",
        "Â  Â  Â  Â  Â  Â  novo_responsavel = nome\n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  for c in CONSULTORES:",
        "Â  Â  Â  Â  Â  Â  Â  Â  if st.session_state['status_texto'].get(c) == 'BastÃ£o':",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['status_texto'][c] = ''",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  st.session_state['status_texto'][novo_responsavel] = 'BastÃ£o'\n",
        "Â  Â  Â  Â  Â  Â  st.session_state['bastao_start_time'] = datetime.now()\n",
        "Â  Â  Â  Â  Â  Â  st.session_state['current_status_starts'][novo_responsavel] = datetime.now()\n",
        "Â  Â  Â  Â  Â  Â  st.session_state['play_sound'] = True\n",
        "Â  Â  Â  Â  Â  Â  st.session_state['gif_warning'] = False \n",
        "Â  Â  Â  Â  Â  Â  st.session_state['skip_status_display'][novo_responsavel] = False \n",
        "Â  Â  Â  Â  Â  Â  send_chat_notification_internal(novo_responsavel, 'BastÃ£o')\n",
        "Â  Â  Â  Â  Â  Â  save_state()\n",
        "Â  Â  Â  Â  Â  Â  st.rerun()\n",
        "Â  Â  Â  Â  Â  Â  return\n",
        "Â  Â  \n",
        "Â  Â  if current_responsavel and st.session_state['status_texto'].get(current_responsavel) in STATUSES_DE_SAIDA:\n",
        "Â  Â  Â  Â  st.session_state['status_texto'][current_responsavel] = ''\n",
        "Â  Â  Â  Â  st.session_state['bastao_start_time'] = None\n",
        "Â  Â  Â  Â  save_state()\n",
        "Â  Â  Â  Â  st.rerun()\n",
        "Â  Â  \n",
        "def update_queue(consultor):\n",
        "Â  Â  st.session_state['gif_warning'] = False \n",
        "Â  Â  checkbox_key = f'check_{consultor}'\n",
        "Â  Â  is_checked = st.session_state.get(checkbox_key, False)\n",
        "Â  Â  old_status = st.session_state['status_texto'].get(consultor, '') or 'DisponÃ­vel'\n",
        "Â  Â  \n",
        "Â  Â  if is_checked and consultor not in st.session_state['bastao_queue']:\n",
        "Â  Â  Â  Â  duration = datetime.now() - st.session_state['current_status_starts'][consultor]\n",
        "Â  Â  Â  Â  log_status_change(consultor, old_status, 'DisponÃ­vel na Fila', duration)\n",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  priority_queue = st.session_state.get('priority_return_queue', [])\n",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  if consultor in st.session_state['skipped_consultors']:\n",
        "Â  Â  Â  Â  Â  Â  st.session_state['skipped_consultors'].remove(consultor)\n",
        "Â  Â  Â  Â  Â  Â  if not st.session_state['skipped_consultors']:\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['cycle_start_marker'] = None\n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  if consultor in priority_queue:\n",
        "Â  Â  Â  Â  Â  Â  if st.session_state['bastao_queue']:\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['bastao_queue'].insert(1, consultor)\n",
        "Â  Â  Â  Â  Â  Â  else:\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['bastao_queue'].append(consultor)\n",
        "Â  Â  Â  Â  Â  Â  priority_queue.remove(consultor)\n",
        "Â  Â  Â  Â  else:\n",
        "Â  Â  Â  Â  Â  Â  st.session_state['bastao_queue'].append(consultor)\n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  st.session_state['status_texto'][consultor] = ''\n",
        "Â  Â  Â  Â  st.session_state['skip_status_display'][consultor] = False \n",
        "Â  Â  Â  Â  check_and_assume_baton(consultor)\n",
        "Â  Â  elif not is_checked and consultor in st.session_state['bastao_queue']:\n",
        "Â  Â  Â  Â  duration = datetime.now() - st.session_state['current_status_starts'][consultor]\n",
        "Â  Â  Â  Â  log_status_change(consultor, old_status, 'IndisponÃ­vel', duration)\n",
        "Â  Â  Â  Â  st.session_state['bastao_queue'].remove(consultor)\n",
        "Â  Â  Â  Â  st.session_state['status_texto'][consultor] = ''\n",
        "Â  Â  Â  Â  st.session_state['skip_status_display'][consultor] = False \n",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  if consultor in st.session_state['skipped_consultors']:\n",
        "Â  Â  Â  Â  Â  Â  st.session_state['skipped_consultors'].remove(consultor)\n",
        "Â  Â  Â  Â  Â  Â  if not st.session_state['skipped_consultors']:\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['cycle_start_marker'] = None\n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  check_and_assume_baton()\n",
        "Â  Â  save_state()\n",
        "Â  Â  st.rerun()\n",
        "Â  Â  \n",
        "def rotate_bastao():\n",
        "Â  Â  selected_name = st.session_state.get('consultor_selectbox', 'Selecione um nome')\n",
        "Â  Â  st.session_state['gif_warning'] = False \n",
        "Â  Â  if selected_name != 'Selecione um nome' and selected_name in st.session_state['status_texto']:\n",
        "Â  Â  Â  Â  if st.session_state['bastao_queue'] and selected_name == st.session_state['bastao_queue'][0]:\n",
        "Â  Â  Â  Â  Â  Â  antigo_responsavel = selected_name\n",
        "Â  Â  Â  Â  Â  Â  old_status = 'BastÃ£o'\n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  # 1. LÃ³gica de reintroduÃ§Ã£o ANTES da rotaÃ§Ã£o (se for o marcador)\n",
        "Â  Â  Â  Â  Â  Â  if antigo_responsavel == st.session_state.get('cycle_start_marker') and st.session_state['skipped_consultors']:\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['bastao_queue'].pop(0)\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['bastao_queue'].append(antigo_responsavel)\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['bastao_queue'].extend(st.session_state['skipped_consultors'])\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['skipped_consultors'] = []\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['cycle_start_marker'] = None\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  Â  Â  pass \n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  # 2. RotaÃ§Ã£o PadrÃ£o (sÃ³ executa se nÃ£o houve reintroduÃ§Ã£o do ciclo)\n",
        "Â  Â  Â  Â  Â  Â  else: \n",
        "Â  Â  Â  Â  Â  Â  Â  Â  if selected_name in st.session_state['bastao_queue']:\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['bastao_queue'].remove(selected_name)\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['bastao_queue'].append(selected_name)\n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  # 3. Log e atualizaÃ§Ã£o de status\n",
        "Â  Â  Â  Â  Â  Â  st.session_state['status_texto'][antigo_responsavel] = ''\n",
        "Â  Â  Â  Â  Â  Â  duration = datetime.now() - st.session_state['current_status_starts'][antigo_responsavel]\n",
        "Â  Â  Â  Â  Â  Â  log_status_change(antigo_responsavel, old_status, 'DisponÃ­vel na Fila', duration)\n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  st.session_state['bastao_counts'][antigo_responsavel] = st.session_state['bastao_counts'].get(antigo_responsavel, 0) + 1\n",
        "Â  Â  Â  Â  Â  Â  st.session_state['play_sound'] = True\n",
        "Â  Â  Â  Â  Â  Â  st.session_state['skip_status_display'][antigo_responsavel] = False \n",
        "Â  Â  Â  Â  Â  Â  checkbox_key = f'check_{selected_name}'\n",
        "Â  Â  Â  Â  Â  Â  st.session_state[checkbox_key] = True\n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  check_and_assume_baton()\n",
        "Â  Â  Â  Â  Â  Â  st.rerun()\n",
        "Â  Â  Â  Â  else:\n",
        "Â  Â  Â  Â  Â  Â  st.session_state['gif_warning'] = True \n",
        "Â  Â  Â  Â  Â  Â  st.rerun()\n",
        "Â  Â  \n",
        "def skip_turn():\n",
        "Â  Â  st.session_state['gif_warning'] = False \n",
        "Â  Â  selected_name = st.session_state.get('consultor_selectbox', 'Selecione um nome')\n",
        "Â  Â  if selected_name != 'Selecione um nome' and selected_name in st.session_state['status_texto']:\n",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  queue = st.session_state['bastao_queue']\n",
        "Â  Â  Â  Â  current_status = st.session_state['status_texto'].get(selected_name, '')\n",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  if selected_name not in queue and current_status != 'BastÃ£o':\n",
        "Â  Â  Â  Â  Â  Â  Â st.warning('O consultor selecionado deve estar na fila ou com o BastÃ£o para Pular.')\n",
        "Â  Â  Â  Â  Â  Â  Â return\n",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  if selected_name in queue:\n",
        "Â  Â  Â  Â  Â  Â  # 1. MARCADOR DE CICLO: Se esta Ã© a primeira pessoa a pular, marca quem estÃ¡ no topo da fila\n",
        "Â  Â  Â  Â  Â  Â  if not st.session_state['skipped_consultors']:\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  if queue:\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['cycle_start_marker'] = queue[0] \n",
        "Â  Â  Â  Â  Â  Â  Â  Â  else:\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['cycle_start_marker'] = None\n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  # 2. Log e manipulaÃ§Ã£o de estado\n",
        "Â  Â  Â  Â  Â  Â  old_status = current_status or 'DisponÃ­vel'\n",
        "Â  Â  Â  Â  Â  Â  duration = datetime.now() - st.session_state['current_status_starts'][selected_name]\n",
        "Â  Â  Â  Â  Â  Â  log_status_change(selected_name, old_status, 'Pulou Turno (Fora da Fila)', duration)\n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  # 3. Remove da fila principal e adiciona Ã  lista de pulo\n",
        "Â  Â  Â  Â  Â  Â  queue.remove(selected_name)\n",
        "Â  Â  Â  Â  Â  Â  st.session_state['skipped_consultors'].append(selected_name)\n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  # 4. Limpa o status e ativa o marcador visual\n",
        "Â  Â  Â  Â  Â  Â  st.session_state['status_texto'][selected_name] = '' \n",
        "Â  Â  Â  Â  Â  Â  st.session_state['skip_status_display'][selected_name] = True \n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  # 5. O CHECKBOX DEVE PERMANECER MARCADO (NÃƒO FAZER NADA AQUI)\n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  # 6. Tenta passar o bastÃ£o para o prÃ³ximo\n",
        "Â  Â  Â  Â  Â  Â  check_and_assume_baton()\n",
        "Â  Â  Â  Â  Â  Â  save_state()\n",
        "Â  Â  Â  Â  Â  Â  st.rerun()\n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  elif current_status == 'BastÃ£o':\n",
        "Â  Â  Â  Â  Â  Â  Â st.warning('O consultor com o bastÃ£o deve usar o botÃ£o **BastÃ£o** ou **Status de SaÃ­da**.')\n",
        "Â  Â  Â  Â  Â  Â  Â return\n",
        "Â  Â  \n",
        "def update_status(status_text, change_to_available):\n",
        "Â  Â  selected_name = st.session_state.get('consultor_selectbox', 'Selecione um nome')\n",
        "Â  Â  st.session_state['gif_warning'] = False \n",
        "Â  Â  \n",
        "Â  Â  if selected_name != 'Selecione um nome' and selected_name in st.session_state['status_texto']:\n",
        "Â  Â  Â  Â  old_status = st.session_state['status_texto'].get(selected_name, '') or 'DisponÃ­vel'\n",
        "Â  Â  Â  Â  new_status = status_text if status_text != '' else 'DisponÃ­vel'\n",
        "Â  Â  Â  Â  duration = datetime.now() - st.session_state['current_status_starts'][selected_name]\n",
        "Â  Â  Â  Â  log_status_change(selected_name, old_status, new_status, duration)\n",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  st.session_state['status_texto'][selected_name] = status_text\n",
        "Â  Â  Â  Â  checkbox_key = f'check_{selected_name}'\n",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  if change_to_available is not None:\n",
        "Â  Â  Â  Â  Â  Â  st.session_state[checkbox_key] = change_to_available\n",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  st.session_state['skip_status_display'][selected_name] = False\n",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  if selected_name in st.session_state['skipped_consultors']:\n",
        "Â  Â  Â  Â  Â  Â  st.session_state['skipped_consultors'].remove(selected_name)\n",
        "Â  Â  Â  Â  Â  Â  if not st.session_state['skipped_consultors']:\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['cycle_start_marker'] = None\n",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  if status_text in STATUSES_DE_SAIDA:\n",
        "Â  Â  Â  Â  Â  Â  if selected_name in st.session_state['bastao_queue']:\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['bastao_queue'].remove(selected_name)\n",
        "Â  Â  Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  Â  Â  if status_text in STATUS_SAIDA_PRIORIDADE:\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  if selected_name not in st.session_state['priority_return_queue']:\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['priority_return_queue'].append(selected_name)\n",
        "Â  Â  Â  Â  Â  Â  elif selected_name in st.session_state.get('priority_return_queue', []):\n",
        "Â  Â  Â  Â  Â  Â  Â  Â  st.session_state['priority_return_queue'].remove(selected_name)\n",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  check_and_assume_baton()\n",
        "Â  Â  Â  Â  save_state()\n",
        "Â  Â  Â  Â  st.rerun()\n",
        "Â  Â  \n",
        "Â  Â  ",
        "# --- INÃCIO DA APLICAÃ‡ÃƒO STREAMLIT (app.py) ---",
        "",
        "if 'gif_warning' not in st.session_state:",
        "Â  Â  st.session_state['gif_warning'] = False",
        "if 'play_sound' not in st.session_state:",
        "Â  Â  st.session_state['play_sound'] = False",
        "if 'last_rerun_time' not in st.session_state:",
        "Â  Â  st.session_state['last_rerun_time'] = datetime.now()",
        "",
        "init_session_state()",Â 
        "",
        "st_autorefresh(interval=30000, key='auto_rerun_key')",
        "",
        "st.markdown(\"""<style>div.stAlert { display: none !important; }</style>\"\"\", unsafe_allow_html=True)",
        "st.set_page_config(page_title='Controle BastÃ£o Cesupe', layout='wide')",

        "st.title(f'Controle BastÃ£o Cesupe {BASTAO_EMOJI}')",
        'st.markdown("<hr style=\\"border: 1px solid #E75480;\\">", unsafe_allow_html=True)',

        "if st.session_state['gif_warning']:",
        "Â  Â  st.error('ğŸš« Apenas o consultor com o bastÃ£o pode transferir o bastÃ£o!')",
        "Â  Â  col_gif, col_spacer = st.columns([0.2, 0.8])",
        "Â  Â  col_gif.image(GIF_URL, width=150)",

        'col_principal, col_disponibilidade = st.columns([1.5, 1])',

        "# RESPONSÃVEL PELO BASTÃƒO (LÃ“GICA DA FILA)",
        "responsavel = st.session_state['bastao_queue'][0] if st.session_state['bastao_queue'] else ''",
        "proximo_responsavel = st.session_state['bastao_queue'][1] if len(st.session_state['bastao_queue']) > 1 else ''",
        "fila_restante = st.session_state['bastao_queue'][2:]",

        "with col_principal:",
        'Â  Â  st.header("ResponsÃ¡vel pelo BastÃ£o")',

        "Â  Â  col_gif, col_time = st.columns([0.25, 0.75])",
        "Â  Â  col_gif.image('https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExYjlqeWg3bXpuZ2ltMXdsNXJ6OW13eWF5aXlqYnc1NGNjamFjczlpOSZlcD12MV9pbnRlcm5uYWxfZ2lmX2J5X2lkJmN0PWc/xAFPuHVjmsBmU/giphy.gif', width=50)",

        "Â  Â  bastao_duration = timedelta()",
        "Â  Â  if responsavel and st.session_state.get('bastao_start_time'):",
        "Â  Â  Â  Â  start_time = st.session_state['bastao_start_time']",
        "Â  Â  Â  Â  try: bastao_duration = datetime.now() - start_time",
        "Â  Â  Â  Â  except: pass",
        "Â  Â  Â  Â  duration_text = format_time_duration(bastao_duration)",
        "Â  Â  Â  Â  col_time.markdown(f'#### ğŸ•’ Tempo: **{duration_text}**')",
        "Â  Â  else:",
        "Â  Â  Â  Â  col_time.markdown('#### ğŸ•’ Tempo: --:--:--')",
        "",
        "Â  Â  st.text_input(label='ResponsÃ¡vel', value=responsavel, disabled=True, label_visibility='collapsed')",
        'Â  Â  st.markdown("###")',

        # EXIBIÃ‡ÃƒO DA FILA COMPLETA
        'Â  Â  st.header("PrÃ³ximos da Fila")',
        "Â  Â  if proximo_responsavel:",
        "Â  Â  Â  Â  st.markdown(f'1Âº: **{proximo_responsavel}**')",
        "Â  Â  Â  Â  if fila_restante:",
        "Â  Â  Â  Â  Â  Â  st.markdown(f'2Âº em diante: {', '.join(fila_restante)}')",
        "Â  Â  else:",
        'Â  Â  Â  Â  st.markdown("*Fila vazia. Marque consultores como DisponÃ­veis.*")',
        "Â  Â  Â  Â  ",
        # ADICIONA A EXIBIÃ‡ÃƒO DE QUEM PULOU A VEZ
        "Â  Â  if st.session_state['skipped_consultors']:",
        "Â  Â  Â  Â  skipped_list = ', '.join(st.session_state['skipped_consultors'])",
        "Â  Â  Â  Â  st.markdown(f'<span style=\"color:orange;\">ğŸš« Pulou a vez (Volta no prÃ³ximo ciclo):</span> {skipped_list}', unsafe_allow_html=True)",
        "Â  Â  Â  Â  ",
        'Â  Â  st.markdown("###")',

        'Â  Â  st.header("**Consultor**")',
        "Â  Â  st.selectbox(",
        'Â  Â  Â  Â  "Selecione o Consultor:",',
        "Â  Â  Â  Â  options=['Selecione um nome'] + CONSULTORES,",
        "Â  Â  Â  Â  index=0,",
        "Â  Â  Â  Â  key='consultor_selectbox',",
        "Â  Â  Â  Â  label_visibility='collapsed'",
        "Â  Â  )",
        'Â  Â  st.markdown("#### ")',
        'Â  Â  st.markdown("**Mudar Status:**")',

        # 5 COLUNAS
        'Â  Â  col_b1, col_b2, col_b3, col_b4, col_b5 = st.columns(5)',

        # BotÃµes de AÃ§Ã£o
        "Â  Â  col_b1.button('ğŸ¯ BastÃ£o', on_click=rotate_bastao, use_container_width=True)",
        "Â  Â  col_b2.button('â­ï¸ Pular', on_click=skip_turn, use_container_width=True)",
        "Â  Â  col_b3.button('âœï¸ Atividade', on_click=update_status, args=('Atividade', False,), use_container_width=True)",
        "Â  Â  col_b4.button('ğŸ½ï¸ AlmoÃ§o', on_click=update_status, args=('AlmoÃ§o', False,), use_container_width=True)",
        "Â  Â  col_b5.button('ğŸš¶ SaÃ­da', on_click=update_status, args=('SaÃ­da TemporÃ¡ria', False,), use_container_width=True)",

        'Â  Â  st.markdown("####")',
        "Â  Â  st.button('ğŸ”„ Atualizar (Manual)', on_click=manual_rerun, use_container_width=True)",

        'Â  Â  st.markdown("---")',

        # Coluna de Disponibilidade
        "with col_disponibilidade:",
        'Â  Â  st.header("**DisponÃ­vel**")',
        'Â  Â  st.subheader("Marque para DisponÃ­vel | Status de Atividade:")',

        # LÃ³gica de cores para os status
        "Â  Â  STATUS_MAP = {",
        "Â  Â  Â  Â  'BastÃ£o': ('#E75480', 'ğŸ†'),",
        "Â  Â  Â  Â  'Atividade': ('#ffc107', 'âœï¸'),",
        "Â  Â  Â  Â  'AlmoÃ§o': ('#007bff', 'ğŸ½ï¸'),",
        "Â  Â  Â  Â  'SaÃ­da TemporÃ¡ria': ('#dc3545', 'ğŸš¶'),",
        "Â  Â  Â  Â  '': ('#6c757d', ''),",
        "Â  Â  }",

        "Â  Â  for nome in CONSULTORES:",
        'Â  Â  Â  Â  col_status, col_nome, col_check = st.columns([0.2, 1, 0.2])',
        "Â  Â  Â  Â  checkbox_key = f'check_{nome}'",

        "Â  Â  Â  Â  if checkbox_key not in st.session_state:",
        "Â  Â  Â  Â  Â  Â  st.session_state[checkbox_key] = nome in st.session_state['bastao_queue']",
        "Â  Â  Â  Â  Â  Â  ",
        "Â  Â  Â  Â  is_available = col_check.checkbox(label=' ', key=checkbox_key, on_change=update_queue, args=(nome,), disabled=nome in st.session_state['skipped_consultors'])",
        "Â  Â  Â  Â  current_status_text = st.session_state['status_texto'].get(nome, '')",
        "Â  Â  Â  Â  is_skip_active = st.session_state['skip_status_display'].get(nome, False)",
        "Â  Â  Â  Â  ",
        # LÃ“GICA DE EXIBIÃ‡ÃƒO VISUAL
        "Â  Â  Â  Â  status_color, status_emoji = STATUS_MAP.get(current_status_text, ('#6c757d', ''))",
        "Â  Â  Â  Â  display_name = nome",
        "Â  Â  Â  Â  display_status = ''",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  # Regra de exibiÃ§Ã£o para quem pulou e estÃ¡ marcado (checkbox True)\n",
        "Â  Â  Â  Â  if nome in st.session_state['skipped_consultors'] and is_available:",
        "Â  Â  Â  Â  Â  Â  display_status = ' :orange-badge[PULOU]'",
        "Â  Â  Â  Â  elif current_status_text in STATUSES_DE_SAIDA and current_status_text != '':",
        "Â  Â  Â  Â  Â  Â  display_status = f'<span style=\"color:{status_color};\">{status_emoji} {current_status_text}</span>'",
        "Â  Â  Â  Â  elif nome in st.session_state.get('priority_return_queue', []):",
        "Â  Â  Â  Â  Â  Â  display_status = '<span style=\"color:#ffc107;\">âš ï¸ Retorno PrioritÃ¡rio</span>'",
        "Â  Â  Â  Â  elif current_status_text == 'BastÃ£o':",
        "Â  Â  Â  Â  Â  Â  display_status = f'<span style=\"color:{status_color};\">**{status_emoji} BASTÃƒO**</span>'",
        "Â  Â  Â  Â  elif current_status_text == '' and is_available and nome != responsavel:",
        "Â  Â  Â  Â  Â  Â  display_status = '<span style=\"color:#007bff;\">âœ… DisponÃ­vel na Fila</span>'",
        "Â  Â  Â  Â  elif not is_available:",
        "Â  Â  Â  Â  Â  Â  display_status = '<span style=\"color:#dc3545;\">âŒ IndisponÃ­vel</span>'",
        "Â  Â  Â  Â  \n",
        "Â  Â  Â  Â  col_status.markdown(f'<span style=\"font-size: 1.5em; color:{status_emoji};\">{status_emoji}</span>', unsafe_allow_html=True)",
        "Â  Â  Â  Â  col_nome.markdown(f'**{display_name}** {display_status}', unsafe_allow_html=True)",

        "Â  Â  current_hour = datetime.now().hour",
        "Â  Â  today = datetime.now().date()",
        "Â  Â  last_run_date = st.session_state['report_last_run_date'].date()",
        "Â  Â  ",
        "Â  Â  if current_hour >= 20 and today > last_run_date:",
        "Â  Â  Â  Â  send_daily_report()",
        "",
        ""
    ]

    return "\n".join(app_code_lines)

# â¬‡ï¸ CHAME A FUNÃ‡ÃƒO generate_app_code E EXECUTE O RESULTADO
app_code_final = generate_app_code(CONSULTORES, BASTAO_EMOJI, GOOGLE_CHAT_WEBHOOK_RELATORIO, CHAT_WEBHOOK_BASTAO, APP_URL_CLOUD)

# â¬…ï¸ EXECUTA O CÃ“DIGO FINAL LIMPO NO AMBIENTE STREAMLIT
exec(app_code_final)
